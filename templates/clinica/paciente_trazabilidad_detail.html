{% extends 'components/Layout/base_extendido.html' %}

{% block content_main %}
<section class="mx-auto max-w-6xl space-y-6 text-white">
  <header class="flex flex-wrap items-start justify-between gap-4">
    <div>
      <p class="text-sm font-semibold text-indigo-300 uppercase tracking-wide">
        Clínica · Trazabilidad
      </p>
      <h1 class="text-3xl font-bold leading-tight text-white">
        Ficha de trazabilidad de paciente
      </h1>
      <p class="text-sm text-gray-400">
        Madre → parto → recién nacido → alta clínica.
      </p>
    </div>
    <a href="{% url 'clinica:paciente_list' %}"
       class="text-sm font-semibold text-indigo-200 hover:text-white">
      ← Volver a pacientes
    </a>
  </header>

  <div class="rounded-3xl border border-white/10 bg-slate-900/70 p-6 shadow-2xl shadow-black/20">
    <h2 class="text-lg font-semibold text-white">Datos de la madre</h2>
    <dl class="mt-4 grid gap-4 text-sm sm:grid-cols-2 lg:grid-cols-3">
      <div>
        <dt class="text-xs font-semibold uppercase tracking-wide text-gray-400">Nombre</dt>
        <dd class="mt-1 text-sm text-gray-100">{{ paciente.nombre_completo }}</dd>
      </div>
      <div>
        <dt class="text-xs font-semibold uppercase tracking-wide text-gray-400">RUT</dt>
        <dd class="mt-1 text-sm text-gray-100">{{ paciente.rut }}</dd>
      </div>
      <div>
        <dt class="text-xs font-semibold uppercase tracking-wide text-gray-400">Fecha de nacimiento</dt>
        <dd class="mt-1 text-sm text-gray-100">{{ paciente.fecha_nacimiento|date:"d/m/Y" }}</dd>
      </div>
      <div>
        <dt class="text-xs font-semibold uppercase tracking-wide text-gray-400">Teléfono</dt>
        <dd class="mt-1 text-sm text-gray-100">{{ paciente.telefono|default:"Sin registro" }}</dd>
      </div>
      <div>
        <dt class="text-xs font-semibold uppercase tracking-wide text-gray-400">Dirección</dt>
        <dd class="mt-1 text-sm text-gray-100">{{ paciente.direccion|default:"Sin registro" }}</dd>
      </div>
      <div>
        <dt class="text-xs font-semibold uppercase tracking-wide text-gray-400">Estado civil</dt>
        <dd class="mt-1 text-sm text-gray-100">{{ paciente.get_estado_civil_display|default:"Sin registro" }}</dd>
      </div>
    </dl>
  </div>

  <div class="rounded-3xl border border-white/10 bg-slate-900/70 p-6 shadow-2xl shadow-black/20 space-y-4">
    <div class="flex items-center justify-between">
      <h2 class="text-lg font-semibold text-white">Partos asociados</h2>
      <a href="{% url 'clinica:parto_create' %}?paciente={{ paciente.pk }}" class="text-sm font-semibold text-indigo-300 hover:text-white">Registrar nuevo parto →</a>
    </div>
    {% url 'clinica:parto_create' as parto_create_url %}
    {% with paciente_id=paciente.pk|stringformat:'s' %}
      {% with nuevo=parto_create_url|add:'?paciente='|add:paciente_id %}
        {% include 'clinica/pacientes/_partos_cards.html' with partos=trazabilidad nuevo_parto_url=nuevo %}
      {% endwith %}
    {% endwith %}
  </div>

  {% include 'components/mensajes.html' %}
</section>
{% endblock content_main %}
